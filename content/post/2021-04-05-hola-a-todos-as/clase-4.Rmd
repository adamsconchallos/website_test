---
title: "Clase 4"
subtitle: "Información imperfecta"
author: Adams Ceballos
date: 572XXX
output:
  xaringan::moon_reader:
    css: ['default', 'metropolis', 'metropolis-fonts', 'my-css.css']
    # self_contained: true
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: 191:100


---
exclude: true
```{r setup}
if (!require("pacman")) install.packages("pacman")
pacman::p_load(
  tidyverse, tidylog, xaringanExtra, rlang, patchwork
)
options(htmltools.dir.version = FALSE)
knitr::opts_hooks$set(fig.callout = function(options) {
  if (options$fig.callout) {
    options$echo <- FALSE
  }
knitr::opts_chunk$set(echo = TRUE, fig.align="center")
  options
})
```
```{r xaringanExtra, echo = FALSE}
xaringanExtra::use_xaringan_extra(c("tile_view", "panelset", "webcam"))

```
```{r echo=FALSE}
xaringanExtra::style_panelset(panel_tab_color_active = "red")
```

---

# Estructura

Qué pasa cuando el regulador tiene información imperfecta sobre:
  - MACs?
  - MDs?

Hasta ahora hemos asumido información perfecta. Sabemos que es poco probable que sea así

--

Continuaremos asumiendo que las firmas conocen su propio MAC

y que los reguladores observan las emisiones a nivel de cada firma

---

# Información imperfecta


Cómo pensamos esto?

--

Es poco probable que las firmas le digan al regulador cuál es su MAC

--

Por lo que el regulador tratará de estimarla cuando diseñe la política

--

Naturalmente las estimaciones tienen errores

---
class: dark-slide
background-image: url(clase-4_files/figure-html/seraverdad.jpg)
background-size: contain


---

# Precio vs cantidad (Weitzman 1974)

Partamos comparando impuesto a las emisiones y permisos transables

--

Comenzaremos tomando la función de daño como no conocida y MAC conocidos

--

Luego haremos lo contrario. MAC no conocido y MD conocido

--

Nos enfocaremos principalmente en la eficiencia y queremos entender cuál política entrega el más alto bienestar y por qué

---

# Incertidumbre en la función de daño

- $D(E)$ es la función de daño social
--

- $C(E)$ es la abatimiento marginal agregado
--

- $E^*$ es el nivél óptimo de polución
  - Es definido por $-C'(E) = D'(E)$
--
  
- Sea $\tilde{D}(E)$ y $\tilde{C}(E)$ la función de daño y costos de abatimiento estimadas

--

Primero supongamos que el regulador estima $-C'(E)$ correctamente, pero subestima el daño marginal: $\tilde{D}'(E) < D'(E) \,\, \forall E$

---

# Incertidumbre en la función de daño

El regulador basa su política en las estimaciones $\tilde{D}'(E)$

--

Esto implica que establece:
$$-C'(E) = \tilde{D}'(E)$$

--

Que es resuelta por algún $\tilde{E} > E^*$ porque subestima el daño marginal

--

Cuál es la pérdida de bienestar al enfocarse $\tilde{E}$ en lugar de $E^*$?

Depende la cuantía de la pérdida del instrumento de política?

---

# Incertidumbre en la función de daño

Definamos la pérdida de bienestar (WL) como la diferencia en el costo social total en $\tilde{E}$ vs el nivel eficiente $E^*$:
\begin{align}
WL &= [D(\tilde{E}) + C(\tilde{E})] - [D(E^*) + C(E^*)] \notag\\
  &= [D(\tilde{E}) -D(E^*)] + [ C(\tilde{E}) - C(E^*)]
\end{align}

Esto es equivalente al área bajo la curva de daño marginal y de abatimiento entre los dos niveles de emisiones:
$$WL = \int_{E^*}^{\tilde{E}}D'(E) dE - \int_{E^*}^{\tilde{E}} - C'(E)dE$$


---

# Incertidumbre en la función de daño con permisos


.pull-left[
```{r uncertain_damages_permit_nodwl, echo = FALSE, fig.show = 'hide', warning = F}
damage_1 <- function(x) 1 + x
damage_2 <- function(x) -1 + x
abatement_cost <- function(x) 5 - x
intersections_1 <- tibble(x = c(0, 2, 2, 3, 3, 3),
                        y = c(2, 3, 0, 4, 2, 0))
polys_dwl <- tibble(x = c(2, 3, 3),
                     y = c(3, 4, 2))
ggplot() +
  stat_function(fun = damage_1, color = "#638ccc", size = 1.5) +
  stat_function(fun = damage_2, color = "#ca5670", size = 1.5) +
  stat_function(fun = abatement_cost, color = "darkslateblue", size = 1.5) +
  annotate("text", size = 8, label = "D'(E)", x = 3, y = 4.5) +
  annotate("text", size = 8, label = expression(tilde(D)*minute (E)), x = 4, y = 2.5) +
  annotate("text", size = 8, label = expression(-C*minute (E)), x = 4.5, y = 1) +
  theme_minimal()  +
  theme(
    legend.position = "none",
    title = element_text(size = 24),
    axis.text.x = element_text(size = 18, color = "#eeeeee"),
    axis.text.y = element_text(size = 18, color = "#eeeeee"),
    axis.title.x = element_text(size = 24), axis.title.y = element_text(size = 24),
    panel.grid.minor.x = element_blank(), panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(), panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#eeeeee", colour = NA),
    plot.background = element_rect(fill = "#eeeeee", colour = NA),
    axis.line = element_line(colour = "black")
  ) +
  labs(x = "Emisiones",
       y = "MAC/MD ($)",
       title = "MD incierta con permisos") +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 5)) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 5))

```

![MD incierta con permisos](`r knitr::fig_chunk("uncertain_damages_permit_nodwl", "png")`)
]

.pull-right[

Este es el caso

Resolver para $\tilde{E}, E^*$ y la pérdida de bienestar por fijar el número de permisos en $L = \tilde{E}$

]

---

# Incertidumbre en la función de daño con permisos


.pull-left[
```{r uncertain_damages_permit, echo = FALSE, fig.show = 'hide', warning = F}
damage_1 <- function(x) 1 + x
damage_2 <- function(x) -1 + x
abatement_cost <- function(x) 5 - x
intersections_1 <- tibble(x = c(0, 2, 2, 3, 3, 3),
                        y = c(2, 3, 0, 4, 2, 0))
polys_dwl <- tibble(x = c(2, 3, 3),
                     y = c(3, 4, 2))
ggplot() +
  geom_polygon(data = polys_dwl, aes(x = x, y = y), fill = "red", alpha = 0.2) +
  annotate("segment", x = intersections_1$x[1], xend = intersections_1$x[5],
           y = intersections_1$y[1], yend = intersections_1$y[5],
           linetype = "dashed", size = 1, color = "black") +
  annotate("segment", x = intersections_1$x[2], xend = intersections_1$x[3],
           y = intersections_1$y[2], yend = intersections_1$y[3],
           linetype = "dashed", size = 1, color = "black") +
  annotate("segment", x = intersections_1$x[4], xend = intersections_1$x[6],
           y = intersections_1$y[4], yend = intersections_1$y[6],
           linetype = "dashed", size = 1, color = "black") +
  stat_function(fun = damage_1, color = "#638ccc", size = 1.5) +
  stat_function(fun = damage_2, color = "#ca5670", size = 1.5) +
  stat_function(fun = abatement_cost, color = "darkslateblue", size = 1.5) +
  annotate("text", size = 8, label = "A", x = 2.6, y = 3) +
  annotate("text", size = 8, label = "D'(E)", x = 3, y = 4.5) +
  annotate("text", size = 8, label = expression(tilde(D)*minute (E)), x = 4, y = 2.5) +
  annotate("text", size = 8, label = expression(-C*minute (E)), x = 4.5, y = 1) +
  theme_minimal()  +
  theme(
    legend.position = "none",
    title = element_text(size = 24),
    axis.text.x = element_text(size = 18, color = "black"),
    axis.text.y = element_text(size = 18, color = "black"),
    axis.title.x = element_text(size = 24), axis.title.y = element_text(size = 24),
    panel.grid.minor.x = element_blank(), panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(), panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#eeeeee", colour = NA),
    plot.background = element_rect(fill = "#eeeeee", colour = NA),
    axis.line = element_line(colour = "black")
  ) +
  labs(x = "Emisiones",
       y = "MAC/MD ($)",
       title = "MD incierta con permisos") +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 5),
                     breaks = c(intersections_1$x[2], intersections_1$x[4]), labels = expression(E^"*", tilde(E))) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 5),
                     breaks = c(intersections_1$y[1]), labels = expression(sigma(tilde(E))))

```

![MD incierta con permisos](`r knitr::fig_chunk("uncertain_damages_permit", "png")`)
]

.pull-right[

Con un esquema de permisos el regulador fija el monto total de las emisiones en $\tilde{E}$

Dado que subestima $D'$, permite a las firmas emitir mucho

Incurre en una pérdida de bienestar $A$ por emisiones donde el MD $>$ MAC

]


---

# MD incierta con impuestos


.pull-left[
```{r uncertain_damages_permit_nodwl_tax, echo = FALSE, fig.show = 'hide', warning = F}
damage_1 <- function(x) 1 + x
damage_2 <- function(x) -1 + x
abatement_cost <- function(x) 5 - x
intersections_1 <- tibble(x = c(0, 2, 2, 3, 3, 3),
                        y = c(2, 3, 0, 4, 2, 0))
polys_dwl <- tibble(x = c(2, 3, 3),
                     y = c(3, 4, 2))
ggplot() +
  stat_function(fun = damage_1, color = "#638ccc", size = 1.5) +
  stat_function(fun = damage_2, color = "#ca5670", size = 1.5) +
  stat_function(fun = abatement_cost, color = "darkslateblue", size = 1.5) +
  annotate("text", size = 8, label = "D'(E)", x = 3, y = 4.5) +
  annotate("text", size = 8, label = expression(tilde(D)*minute (E)), x = 4, y = 2.5) +
  annotate("text", size = 8, label = expression(-C*minute (E)), x = 4.5, y = 1) +
  theme_minimal()  +
  theme(
    legend.position = "none",
    title = element_text(size = 24),
    axis.text.x = element_text(size = 18, color = "#eeeeee"),
    axis.text.y = element_text(size = 18, color = "#eeeeee"),
    axis.title.x = element_text(size = 24), axis.title.y = element_text(size = 24),
    panel.grid.minor.x = element_blank(), panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(), panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#eeeeee", colour = NA),
    plot.background = element_rect(fill = "#eeeeee", colour = NA),
    axis.line = element_line(colour = "black")
  ) +
  labs(x = "Emisiones",
       y = "MAC/MD ($)",
       title = "MD incierta con impuestos") +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 5)) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 5))

```

![MD incierta con impuestos](`r knitr::fig_chunk("uncertain_damages_permit_nodwl_tax", "png")`)
]

.pull-right[

El caso

resolver para $\tilde{E}, E^*$ y $E(\tau)$ que es la elección de la firma dado $\tau$, y la pérdida de bienestar de establecer el impuesto en $\tau(\tilde{E})$ que alcanza $E=\tilde{E}$ dado $-\tilde{C}'(E)$

]

---

# MD incierta con impuestos


.pull-left[
```{r uncertain_damages_tax, echo = FALSE, fig.show = 'hide', warning = F}
damage_1 <- function(x) 1 + x
damage_2 <- function(x) -1 + x
abatement_cost <- function(x) 5 - x
intersections_1 <- tibble(x = c(0, 2, 2, 3, 3, 3),
                        y = c(2, 3, 0, 4, 2, 0))
polys_dwl <- tibble(x = c(2, 3, 3),
                     y = c(3, 4, 2))
ggplot() +
  geom_polygon(data = polys_dwl, aes(x = x, y = y), fill = "red", alpha = 0.2) +
  annotate("segment", x = intersections_1$x[1], xend = intersections_1$x[5],
           y = intersections_1$y[1], yend = intersections_1$y[5],
           linetype = "dashed", size = 1, color = "black") +
  annotate("segment", x = intersections_1$x[2], xend = intersections_1$x[3],
           y = intersections_1$y[2], yend = intersections_1$y[3],
           linetype = "dashed", size = 1, color = "black") +
  annotate("segment", x = intersections_1$x[4], xend = intersections_1$x[6],
           y = intersections_1$y[4], yend = intersections_1$y[6],
           linetype = "dashed", size = 1, color = "black") +
  stat_function(fun = damage_1, color = "#638ccc", size = 1.5) +
  stat_function(fun = damage_2, color = "#ca5670", size = 1.5) +
  stat_function(fun = abatement_cost, color = "darkslateblue", size = 1.5) +
  annotate("text", size = 8, label = "D'(E)", x = 3, y = 4.5) +
  annotate("text", size = 8, label = expression(tilde(D)*minute (E)), x = 4, y = 2.5) +
  annotate("text", size = 8, label = expression(-C*minute (E)), x = 4.5, y = 1) +
  annotate("text", size = 8, label = "A", x = 2.6, y = 3) +
  theme_minimal()  +
  theme(
    legend.position = "none",
    title = element_text(size = 24),
    axis.text.x = element_text(size = 18, color = "black"),
    axis.text.y = element_text(size = 18, color = "black"),
    axis.title.x = element_text(size = 24), axis.title.y = element_text(size = 24),
    panel.grid.minor.x = element_blank(), panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(), panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#eeeeee", colour = NA),
    plot.background = element_rect(fill = "#eeeeee", colour = NA),
    axis.line = element_line(colour = "black")
  ) +
  labs(x = "Emisiones",
       y = "MAC/MD ($)",
       title = "MD incierta con impuestos") +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 5),
                     breaks = c(intersections_1$x[2], intersections_1$x[4]), labels = expression(E^"*", tilde(E))) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 5),
                     breaks = c(intersections_1$y[1]), labels = expression(tau(tilde(E))))

```

![MD incierta con impuestos](`r knitr::fig_chunk("uncertain_damages_tax", "png")`)
]

.pull-right[

El regulador establece el impuesto como función de las emisiones objetivo $\tau(\tilde{E})$

dado que subestima $D'$, establece $\tau(\tilde{E})$ muy bajo

La firma escoge $E(\tau) = \tilde{E}$

Incurre en una pérdida de bienestar $A$ por emisiones donde el MD $>$ MAC



]


---

# Incertidumbre en MD

Qué aprendimos?

--

Con incertidumbre en MD el regulador establecerá un nivel de política incorrecto

--

Si subestima MD:
--

  - Establece el número de permisos muy alto
  - Establece un impuesto muy bajo

--

Ambos llevan a la misma pérdida de bienestar por lo que ambas políticas tienen la misma eficiencia

---

# Costos de abatimiento bajo incertidumbre

Suponga que el regulador estima correctamente $D'(E)$ y subestima MAC: $-\tilde{C}'(E) < -C'(E) \,\, \forall E$


El regulador escoge la política basado en sus estimaciones $-\tilde{C}'(E)$

--

Esto implica que establece:
$$-\tilde{C}'(E) = D'(E)$$
Lo que es resuelto por algún $\tilde{E} < E^*$ porque subestima los costos marginales

--

Cuál es la pérdida de bienestar de tener por objetivo $\tilde{E}$ en lugar de $E^*$?


---

# Función de costos de abatimiento incierta


.pull-left[
```{r uncertain_abatement_nodwl, echo = FALSE, fig.show = 'hide', warning = F}
damage <- function(x) 1 + x
abatement_cost_1 <- function(x) 5 - x
abatement_cost_2 <- function(x) 3 - x

intersections_1 <- tibble(x = c(0, 2, 2, 3, 3, 3, 1, 1, 0),
                        y = c(2, 3, 0, 4, 2, 0, 0, 4, 4))
polys_dwl <- tibble(x = c(2, 3, 3),
                     y = c(3, 4, 2))
polys_dwl_2 <- tibble(x = c(2, 1, 1),
                     y = c(3, 4, 2))
ggplot() +
  stat_function(fun = abatement_cost_1, color = "#638ccc", size = 1.5) +
  stat_function(fun = abatement_cost_2, color = "#ca5670", size = 1.5) +
  stat_function(fun = damage, color = "darkslateblue", size = 1.5) +
  annotate("text", size = 8, label = expression(D*minute (E)), x = 3, y = 4.5) +
  annotate("text", size = 8, label = expression(-C*minute (E)), x = 4.5, y = 1) +
  annotate("text", size = 8, label = expression(-tilde(C)*minute (E)), x = 0.5, y = 3.25) +
  theme_minimal()  +
  theme(
    legend.position = "none",
    title = element_text(size = 24),
    axis.text.x = element_text(size = 18, color = "#eeeeee"),
    axis.text.y = element_text(size = 18, color = "#eeeeee"),
    axis.title.x = element_text(size = 24), axis.title.y = element_text(size = 24),
    panel.grid.minor.x = element_blank(), panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(), panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#eeeeee", colour = NA),
    plot.background = element_rect(fill = "#eeeeee", colour = NA),
    axis.line = element_line(colour = "black")
  ) +
  labs(x = "Emisiones",
       y = "MAC/MD ($)",
       title = "MAC incierta") +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 5)) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 5))

```


![MAC incierta quiebra la equivalencia entre impuestos y permisos](`r knitr::fig_chunk("uncertain_abatement_nodwl", "png")`)
]

.pull-right[

Aquí el problema de la MAC incierta

resolver para $\tilde{E}, E^*, \sigma(\tilde{E}),$ y la perdida de bienestar de establecer un número de permisos igual a $L = \tilde{E}$

resolver para $\tilde{E}, E^*,$ y $E(\tau)$ que es la elección de emisiones de la firma dado $\tau$, y la pérdida de eficiencia de establecer un impuesto $\tau(\tilde{E})$

]



---

# Función de costos de abatimiento incierta


.pull-left[
```{r uncertain_abatement, echo = FALSE, fig.show = 'hide', warning = F}
damage <- function(x) 1 + x
abatement_cost_1 <- function(x) 5 - x
abatement_cost_2 <- function(x) 3 - x

intersections_1 <- tibble(x = c(0, 2, 2, 3, 3, 3, 1, 1, 0),
                        y = c(2, 3, 0, 4, 2, 0, 0, 4, 4))
polys_dwl <- tibble(x = c(2, 3, 3),
                     y = c(3, 4, 2))
polys_dwl_2 <- tibble(x = c(2, 1, 1),
                     y = c(3, 4, 2))
ggplot() +
  geom_polygon(data = polys_dwl, aes(x = x, y = y), fill = "red", alpha = 0.2) +
  geom_polygon(data = polys_dwl_2, aes(x = x, y = y), fill = "blue", alpha = 0.2) +
  annotate("segment", x = intersections_1$x[1], xend = intersections_1$x[5],
           y = intersections_1$y[1], yend = intersections_1$y[5],
           linetype = "dashed", size = 1, color = "black") +
  annotate("segment", x = intersections_1$x[2], xend = intersections_1$x[3],
           y = intersections_1$y[2], yend = intersections_1$y[3],
           linetype = "dashed", size = 1, color = "black") +
  annotate("segment", x = intersections_1$x[4], xend = intersections_1$x[6],
           y = intersections_1$y[4], yend = intersections_1$y[6],
           linetype = "dashed", size = 1, color = "black") +
  annotate("segment", x = intersections_1$x[7], xend = intersections_1$x[8],
           y = intersections_1$y[7], yend = intersections_1$y[8],
           linetype = "dashed", size = 1, color = "black") +
  annotate("segment", x = intersections_1$x[9], xend = intersections_1$x[8],
           y = intersections_1$y[9], yend = intersections_1$y[8],
           linetype = "dashed", size = 1, color = "black") +
  stat_function(fun = abatement_cost_1, color = "#638ccc", size = 1.5) +
  stat_function(fun = abatement_cost_2, color = "#ca5670", size = 1.5) +
  stat_function(fun = damage, color = "darkslateblue", size = 1.5) +
  annotate("text", size = 8, label = expression(D*minute (E)), x = 3, y = 4.5) +
  annotate("text", size = 8, label = expression(-C*minute (E)), x = 4.5, y = 1) +
  annotate("text", size = 8, label = expression(-tilde(C)*minute (E)), x = 0.5, y = 3.25) +
  annotate("text", size = 8, label = "B", x = 2.6, y = 3) +
  annotate("text", size = 8, label = "C", x = 1.4, y = 3) +
  theme_minimal()  +
  theme(
    legend.position = "none",
    title = element_text(size = 24),
    axis.text.x = element_text(size = 18, color = "black"),
    axis.text.y = element_text(size = 18, color = "black"),
    axis.title.x = element_text(size = 24), axis.title.y = element_text(size = 24),
    panel.grid.minor.x = element_blank(), panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(), panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#eeeeee", colour = NA),
    plot.background = element_rect(fill = "#eeeeee", colour = NA),
    axis.line = element_line(colour = "black")
  ) +
  labs(x = "Emisiones",
       y = "MAC/MD ($)",
       title =  "MAC incierta") +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 5),
                     breaks = c(intersections_1$x[2], intersections_1$x[4], intersections_1$x[7]), labels = expression(E^"*", E(tau), tilde(E))) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 5),
                     breaks = c(intersections_1$y[1], intersections_1$y[9]), labels = expression(tau(tilde(E)), sigma(tilde(E))))

```


![MAC incierta quiebra la equivalencia entre impuestos y permisos](`r knitr::fig_chunk("uncertain_abatement", "png")`)
]

.pull-right[

Con permisos, el regulador emite $\tilde{E}$ permisos que resulta en un precio por permiso de $\sigma(\tilde{E})$ donde $\tilde{E}$ intersecta la verdadera MAC

Esto produce una pérdida de bienestar de $C$

El comportamiento de la empresa fija el precio aunque la cantidad sea fijada por el regulador

]


---

# Función de costos de abatimiento incierta


.pull-left[
![MAC incierta quiebra la equivalencia entre impuestos y permisos](`r knitr::fig_chunk("uncertain_abatement", "png")`)
]

.pull-right[

Con impuesto, el regulador establece un precio $\tau(\tilde{E})$ por unidad de emisiones, y la firma escoge la cantidad de emisiones donde $\tau(\tilde{E}) = -C'(E)$ que causa un total de emisiones $E(\tau)$

Esto produce una pérdida de bienestar de $B$

El comportamiento de la firma establece la cantidad aún cuando el precio es fijado por el regulador

]

---

# Función de costos de abatimiento incierta


.pull-left[
![MAC incierta quiebra la equivalencia entre impuestos y permisos](`r knitr::fig_chunk("uncertain_abatement", "png")`)
]

.pull-right[

Dado $E(\tau) \neq \tilde{E}$, el costo de abatimiento incierto importa: Permisos transables e impuests nos dan un resultado de emisiones distinto

Hay alguna diferencia sistemática entre las propiedades de eficiencia de los permisos e impuestos?

]

---

# Función de costos de abatimiento incierta


En general parece que la pérdida de bienestar que causan los impuestos es mayor y en otros casos es mayor con los permisos

--

Lo que haremos será tratar de entender las características de la MAC y MD que hacen que una política sea mejor que otra


---

# MD empinada vs plana

```{r prices_vs_quantities_nodwl, echo = FALSE, fig.show = 'hide', warning = F, fig.width=12, fig.height=5}
damage_steep <- function(x) -1.6 + 1.75*x
abatement_cost_1 <- function(x) 5 - x
abatement_cost_2 <- function(x) 3 - x

intersections_1 <- tibble(x = c(0.0, 2.4, 2.4, 5-1.328, 5-1.328, 5-1.328, 1.672, 1.672, 0.0),
                        y =   c(1.328, 2.6, 0.0, -1.6+1.75*(5-1.328), 1.328, 0.0, 0.0, 3.4, 3.4))
polys_dwl <- tibble(x = c(intersections_1$x[2], intersections_1$x[4], intersections_1$x[5]),
                     y = c(intersections_1$y[2], intersections_1$y[4], intersections_1$y[5]))
polys_dwl_2 <- tibble(x = c(intersections_1$x[2], intersections_1$x[7], intersections_1$x[8]),
                     y = c(intersections_1$y[2], intersections_1$y[1], intersections_1$y[8]))
steep <- ggplot() +
  stat_function(fun = abatement_cost_1, color = "#638ccc", size = 1.5) +
  stat_function(fun = abatement_cost_2, color = "#ca5670", size = 1.5) +
  stat_function(fun = damage_steep, color = "darkslateblue", size = 1.5) +
  annotate("text", size = 8, label = expression(D*minute (E)), x = 3, y = 4.5) +
  annotate("text", size = 8, label = expression(-C*minute (E)), x = 4.5, y = 1.15) +
  annotate("text", size = 8, label = expression(-tilde(C)*minute (E)), x = 0.5, y = 3.05) +
  theme_minimal()  +
  theme(
    legend.position = "none",
    title = element_text(size = 24),
    axis.text.x = element_text(size = 18, color = "#eeeeee"),
    axis.text.y = element_text(size = 18, color = "#eeeeee"),
    axis.title.x = element_text(size = 24), axis.title.y = element_text(size = 24),
    panel.grid.minor.x = element_blank(), panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(), panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#eeeeee", colour = NA),
    plot.background = element_rect(fill = "#eeeeee", colour = NA),
    axis.line = element_line(colour = "black")
  ) +
  labs(x = "Emissions",
       y = "MAC/MD ($)",
       title = "Steep MD") +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 5),
                     breaks = c(intersections_1$x[2], intersections_1$x[4], intersections_1$x[7]), labels = expression(E^"*", E(tau), tilde(E))) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 5),
                     breaks = c(intersections_1$y[1], intersections_1$y[9]), labels = expression(tau(tilde(E)), sigma(tilde(E))))


damage_flat <- function(x) 1 + x/2
abatement_cost_1 <- function(x) 5 - x
abatement_cost_2 <- function(x) 3 - x

intersections_1 <- tibble(x = c(0.0, 8/3, 8/3, 5-(3-4/3), 5-(3-4/3), 5-(3-4/3), 4/3, 4/3, 0.0),
                        y =   c(3-4/3, 5-8/3, 0.0, 1+(5-(3-4/3))/2, 3-4/3, 0.0, 0.0, 5-4/3, 5-4/3))
polys_dwl <- tibble(x = c(intersections_1$x[2], intersections_1$x[4], intersections_1$x[5]),
                     y = c(intersections_1$y[2], intersections_1$y[4], intersections_1$y[5]))
polys_dwl_2 <- tibble(x = c(intersections_1$x[2], intersections_1$x[7], intersections_1$x[8]),
                     y = c(intersections_1$y[2], intersections_1$y[1], intersections_1$y[8]))
flat <- ggplot() +
  stat_function(fun = abatement_cost_1, color = "#638ccc", size = 1.5) +
  stat_function(fun = abatement_cost_2, color = "#ca5670", size = 1.5) +
  stat_function(fun = damage_flat, color = "darkslateblue", size = 1.5) +
  annotate("text", size = 8, label = expression(D*minute (E)), x = 4, y = 3.5) +
  annotate("text", size = 8, label = expression(-C*minute (E)), x = 4.5, y = 1.15) +
  annotate("text", size = 8, label = expression(-tilde(C)*minute (E)), x = 0.5, y = 3.05) +
  theme_minimal()  +
  theme(
    legend.position = "none",
    title = element_text(size = 24),
    axis.text.x = element_text(size = 18, color = "#eeeeee"),
    axis.text.y = element_text(size = 18, color = "#eeeeee"),
    axis.title.x = element_text(size = 24), axis.title.y = element_text(size = 24),
    panel.grid.minor.x = element_blank(), panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(), panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#eeeeee", colour = NA),
    plot.background = element_rect(fill = "#eeeeee", colour = NA),
    axis.line = element_line(colour = "black")
  ) +
  labs(x = "Emissions",
       y = "MAC/MD ($)",
       title = "Flat MD") +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 5),
                     breaks = c(intersections_1$x[2], intersections_1$x[4], intersections_1$x[7]), labels = expression(E^"*", E(tau), tilde(E))) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 5),
                     breaks = c(intersections_1$y[1], intersections_1$y[9]), labels = expression(tau(tilde(E)), sigma(tilde(E))))

steep + flat & theme(
    plot.background = element_rect(fill = "#eeeeee", colour = NA))

```

![distribución inicial es importante para el reparto de costos y beneficios](`r knitr::fig_chunk("prices_vs_quantities_nodwl", "png")`)

resolcamos para las DWLs de los permisos e impuestos donde la única diferencia es la inclinación es la curva de daño marginal


---

# MD empinada vs plana

```{r prices_vs_quantities, echo = FALSE, fig.show = 'hide', warning = F, fig.width=12, fig.height=5}
damage_steep <- function(x) -1.6 + 1.75*x
abatement_cost_1 <- function(x) 5 - x
abatement_cost_2 <- function(x) 3 - x

intersections_1 <- tibble(x = c(0.0, 2.4, 2.4, 5-1.328, 5-1.328, 5-1.328, 1.672, 1.672, 0.0),
                        y =   c(1.328, 2.6, 0.0, -1.6+1.75*(5-1.328), 1.328, 0.0, 0.0, 3.4, 3.4))
polys_dwl <- tibble(x = c(intersections_1$x[2], intersections_1$x[4], intersections_1$x[5]),
                     y = c(intersections_1$y[2], intersections_1$y[4], intersections_1$y[5]))
polys_dwl_2 <- tibble(x = c(intersections_1$x[2], intersections_1$x[7], intersections_1$x[8]),
                     y = c(intersections_1$y[2], intersections_1$y[1], intersections_1$y[8]))
steep <- ggplot() +
  geom_polygon(data = polys_dwl, aes(x = x, y = y), fill = "red", alpha = 0.2) +
  geom_polygon(data = polys_dwl_2, aes(x = x, y = y), fill = "blue", alpha = 0.2) +
  annotate("segment", x = intersections_1$x[1], xend = intersections_1$x[5],
           y = intersections_1$y[1], yend = intersections_1$y[5],
           linetype = "dashed", size = 1, color = "black") +
  annotate("segment", x = intersections_1$x[2], xend = intersections_1$x[3],
           y = intersections_1$y[2], yend = intersections_1$y[3],
           linetype = "dashed", size = 1, color = "black") +
  annotate("segment", x = intersections_1$x[4], xend = intersections_1$x[6],
           y = intersections_1$y[4], yend = intersections_1$y[6],
           linetype = "dashed", size = 1, color = "black") +
  annotate("segment", x = intersections_1$x[7], xend = intersections_1$x[8],
           y = intersections_1$y[7], yend = intersections_1$y[8],
           linetype = "dashed", size = 1, color = "black") +
  annotate("segment", x = intersections_1$x[9], xend = intersections_1$x[8],
           y = intersections_1$y[9], yend = intersections_1$y[8],
           linetype = "dashed", size = 1, color = "black") +
  stat_function(fun = abatement_cost_1, color = "#638ccc", size = 1.5) +
  stat_function(fun = abatement_cost_2, color = "#ca5670", size = 1.5) +
  stat_function(fun = damage_steep, color = "darkslateblue", size = 1.5) +
  annotate("text", size = 8, label = expression(D*minute (E)), x = 3, y = 4.5) +
  annotate("text", size = 8, label = expression(-C*minute (E)), x = 4.5, y = 1.15) +
  annotate("text", size = 8, label = expression(-tilde(C)*minute (E)), x = 0.5, y = 3.05) +
  annotate("text", size = 8, label = "A", x = 3.15, y = 2.5) +
  annotate("text", size = 8, label = "B", x = 1.9, y = 2.5) +
  theme_minimal()  +
  theme(
    legend.position = "none",
    title = element_text(size = 24),
    axis.text.x = element_text(size = 18, color = "black"),
    axis.text.y = element_text(size = 18, color = "black"),
    axis.title.x = element_text(size = 24), axis.title.y = element_text(size = 24),
    panel.grid.minor.x = element_blank(), panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(), panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#eeeeee", colour = NA),
    plot.background = element_rect(fill = "#eeeeee", colour = NA),
    axis.line = element_line(colour = "black")
  ) +
  labs(x = "Emissions",
       y = "MAC/MD ($)",
       title = "Steep MD") +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 5),
                     breaks = c(intersections_1$x[2], intersections_1$x[4], intersections_1$x[7]), labels = expression(E^"*", E(tau), tilde(E))) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 5),
                     breaks = c(intersections_1$y[1], intersections_1$y[9]), labels = expression(tau(tilde(E)), sigma(tilde(E))))


damage_flat <- function(x) 1 + x/2
abatement_cost_1 <- function(x) 5 - x
abatement_cost_2 <- function(x) 3 - x

intersections_1 <- tibble(x = c(0.0, 8/3, 8/3, 5-(3-4/3), 5-(3-4/3), 5-(3-4/3), 4/3, 4/3, 0.0),
                        y =   c(3-4/3, 5-8/3, 0.0, 1+(5-(3-4/3))/2, 3-4/3, 0.0, 0.0, 5-4/3, 5-4/3))
polys_dwl <- tibble(x = c(intersections_1$x[2], intersections_1$x[4], intersections_1$x[5]),
                     y = c(intersections_1$y[2], intersections_1$y[4], intersections_1$y[5]))
polys_dwl_2 <- tibble(x = c(intersections_1$x[2], intersections_1$x[7], intersections_1$x[8]),
                     y = c(intersections_1$y[2], intersections_1$y[1], intersections_1$y[8]))
flat <- ggplot() +
  geom_polygon(data = polys_dwl, aes(x = x, y = y), fill = "red", alpha = 0.2) +
  geom_polygon(data = polys_dwl_2, aes(x = x, y = y), fill = "blue", alpha = 0.2) +
  annotate("segment", x = intersections_1$x[1], xend = intersections_1$x[5],
           y = intersections_1$y[1], yend = intersections_1$y[5],
           linetype = "dashed", size = 1, color = "black") +
  annotate("segment", x = intersections_1$x[2], xend = intersections_1$x[3],
           y = intersections_1$y[2], yend = intersections_1$y[3],
           linetype = "dashed", size = 1, color = "black") +
  annotate("segment", x = intersections_1$x[4], xend = intersections_1$x[6],
           y = intersections_1$y[4], yend = intersections_1$y[6],
           linetype = "dashed", size = 1, color = "black") +
  annotate("segment", x = intersections_1$x[7], xend = intersections_1$x[8],
           y = intersections_1$y[7], yend = intersections_1$y[8],
           linetype = "dashed", size = 1, color = "black") +
  annotate("segment", x = intersections_1$x[9], xend = intersections_1$x[8],
           y = intersections_1$y[9], yend = intersections_1$y[8],
           linetype = "dashed", size = 1, color = "black") +
  stat_function(fun = abatement_cost_1, color = "#638ccc", size = 1.5) +
  stat_function(fun = abatement_cost_2, color = "#ca5670", size = 1.5) +
  stat_function(fun = damage_flat, color = "darkslateblue", size = 1.5) +
  annotate("text", size = 8, label = expression(D*minute (E)), x = 4, y = 3.5) +
  annotate("text", size = 8, label = expression(-C*minute (E)), x = 4.5, y = 1.15) +
  annotate("text", size = 8, label = expression(-tilde(C)*minute (E)), x = 0.5, y = 3.05) +
  annotate("text", size = 8, label = "A", x = 3.15, y = 2.25) +
  annotate("text", size = 8, label = "B", x = 1.9, y = 2.5) +
  theme_minimal()  +
  theme(
    legend.position = "none",
    title = element_text(size = 24),
    axis.text.x = element_text(size = 18, color = "black"),
    axis.text.y = element_text(size = 18, color = "black"),
    axis.title.x = element_text(size = 24), axis.title.y = element_text(size = 24),
    panel.grid.minor.x = element_blank(), panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(), panel.grid.major.x = element_blank(),
    panel.background = element_rect(fill = "#eeeeee", colour = NA),
    plot.background = element_rect(fill = "#eeeeee", colour = NA),
    axis.line = element_line(colour = "black")
  ) +
  labs(x = "Emissions",
       y = "MAC/MD ($)",
       title = "Flat MD") +
  scale_x_continuous(expand = c(0, 0), limits = c(0, 5),
                     breaks = c(intersections_1$x[2], intersections_1$x[4], intersections_1$x[7]), labels = expression(E^"*", E(tau), tilde(E))) +
  scale_y_continuous(expand = c(0, 0), limits = c(0, 5),
                     breaks = c(intersections_1$y[1], intersections_1$y[9]), labels = expression(tau(tilde(E)), sigma(tilde(E))))

steep + flat & theme(
    plot.background = element_rect(fill = "#eeeeee", colour = NA))

```

![distribución inicial es importante para el reparto de costos y beneficios](`r knitr::fig_chunk("prices_vs_quantities", "png")`)

La diferencia entre los gráficos es la pendiente de DM y, por tanto, la política que el regulador establece

La pérdida de bienestar por los impuestos viene dada por $A$, y por los permisos viene dada por $B$


---

# MD empinada vs plana


![distribución inicial es importante para el reparto de costos y beneficios](`r knitr::fig_chunk("prices_vs_quantities", "png")`)

.hi-red[Los permisos lo hacen mejor con una MD empinada, los impuestos lo hacen mejor con una MD plana!]

por qué?

---

# MD empinada vs plana

Con una MD empinada (y conocida):
--

- La diferencia entre $E^*$ y $\tilde{E}$ es restringida: curvas empinadas son más inelásticas, errores en estimar MAC conduce a pequeños errores en $\tilde{E}-E^*$
- La diferencia entre $E^*$ y $E(\tau)$ puede ser muy grande: errores en estimar la MAC conduce a errores grandes en $\tau(\tilde{E}) - \tau(E^*)$ porque MD es muy empinada


---

# MD empinada vs plana

Con una MD plana (y conocida):
--

- La diferencia entre $E^*$ y $\tilde{E}$ puede ser muy grande: Curvas más planas son más elásticas, errores en la estimación de la MAC pueden llevar a grandes errores en $\tilde{E}-E^*$
- La diferencia entre $E^*$ y  $E(\tau)$ es restringida: errores en estimar la MAC puede llevar a errores pequeños en $\tau(\tilde{E}) - \tau(E^*)$ porque MD es muy plna 

<!-- --- -->
